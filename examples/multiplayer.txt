:: Start
$gameStarted: false
--
[align center]
# Multiplayer


[align left]
This is a multiplayer game. You'll need at least one other player to play. 

[align center]
**[[Host a game->Lobby Hosting]]** | **[[Join a game->Lobby Joining 1]]**


:: Lobby Joining 1
config.header.right: '{multiplayer.session.status}'
sessionId: ''
--

Session ID:

{text input for: 'sessionId'}

[[Continue->Lobby Joining 2]] | [[Go back->Start]]


:: Lobby Joining 2
--

[JavaScript]
if(engine.state.get('multiplayer.session.status') === 'Not Connected') {
  // Start joining the game, but wait for the cross-fade transition to finish
  window.setTimeout(() => {
    const sessionId = engine.state.get('sessionId')
    engine.multiplayer.joinGame(sessionId)
  }, 1000)
}

[if multiplayer.session.status == 'Connecting...']
Joining game...

[if multiplayer.session.status == 'Error']
There was an error attempting to join the game with session id: {sessionId}

[[Try again?->Lobby Joining 1]]

[if multiplayer.session.isConnected && multiplayer.peer.isGuest && !$gameStarted]
**You have joined the game!** Waiting for the host to begin...

[if $gameStarted]
{embed passage: 'Guest Start'}


:: Lobby Hosting
config.header.left: 'Hosting'
config.header.right: '{multiplayer.session.status}'
--

[JavaScript]
if(engine.state.get('multiplayer.session.status') === 'Not Connected') {
  // Start hosting the game, but wait for the cross-fade transition to finish
  window.setTimeout(() => {
    engine.multiplayer.hostGame()
  }, 1000)
}

[cont'd]

[if multiplayer.session.status == 'Connecting...']
Setting up game...

[if multiplayer.session.isConnected && multiplayer.peer.isHost]
**You are the host.** Your game's session ID is `{multiplayer.session.id}`.

There are **{multiplayer.session.numConnections}** other players in the lobby.

[if multiplayer.session.numConnections > 0]
[[Start->Host Start]]


:: Host Start
$gameStarted: true
--
{embed passage: 'Coffee Shop'}


:: Guest Start
--
{embed passage: 'Coffee Shop'}


:: Coffee Shop
$gameStarted: true
--

You are in a coffee shop
